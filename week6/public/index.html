<!DOCTYPE html>
<html>
<head>
  <title>Auth App</title>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>

<h2>Signup</h2>
<input id="su_user" placeholder="Username">
<input id="su_pass" type="password" placeholder="Password">
<button onclick="signup()">Signup</button>

<hr>

<h2>Signin</h2>
<input id="si_user" placeholder="Username">
<input id="si_pass" type="password" placeholder="Password">
<button onclick="signin()">Signin</button>

<hr>

<h2>User Info</h2>
<button onclick="getInfo()">Get My Info</button>
<pre id="info"></pre>

<script>
async function signup() {
  const username = document.getElementById("su_user").value;
  const password = document.getElementById("su_pass").value;

  await axios.post("http://localhost:3001/signup", {
    username,
    password
  });

  alert("Signed up");
}

async function signin() {
  const username = document.getElementById("si_user").value;
  const password = document.getElementById("si_pass").value;

  const res = await axios.post("http://localhost:3001/signin", {
    username,
    password
  });

  const token = res.data.token;
  localStorage.setItem("token", token);

  alert("Logged in. Token saved to localStorage");
}

async function getInfo() {
  const token = localStorage.getItem("token");

  const res = await axios.get("http://localhost:3001/get_password", {
    headers: {
      token: token
    }
  });

  document.getElementById("info").innerText =
    JSON.stringify(res.data, null, 2);
}
</script>

</body>
</html>
